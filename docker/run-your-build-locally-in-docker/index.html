<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="no-js ie6"><![endif]-->
<!--[if IE 7 ]><html class="no-js ie7"><![endif]-->
<!--[if IE 8 ]><html class="no-js ie8"><![endif]-->
<!--[if IE 9 ]><html class="no-js ie9"><![endif]-->
<!--[if (gt IE 9)|!(IE)]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1">
    
      
        <title>How to run your build locally in Docker - Bitrise DevCenter</title>
      
      
      
      
    
    <meta property="og:url" content="None">
    <meta property="og:title" content="Bitrise DevCenter">
    <meta property="og:image" content="None/../../img/logo.svg">
    <meta name="apple-mobile-web-app-title" content="Bitrise DevCenter">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
      <link rel="apple-touch-icon" href="../../img/logo.svg">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <link rel="icon" type="image/x-icon" href="../../assets/images/favicon-e565ddfa3b.ico">
    <style>
      @font-face {
      	font-family: 'Icon';
      	src: url('../../assets/fonts/icon.eot?52m981');
      	src: url('../../assets/fonts/icon.eot?#iefix52m981')
               format('embedded-opentype'),
      		   url('../../assets/fonts/icon.woff?52m981')
               format('woff'),
      		   url('../../assets/fonts/icon.ttf?52m981')
               format('truetype'),
      		   url('../../assets/fonts/icon.svg?52m981#icon')
               format('svg');
      	font-weight: normal;
      	font-style: normal;
      }
    </style>
    <link rel="stylesheet" href="../../assets/stylesheets/application-a422ff04cc.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/palettes-05ab2406df.css">
    
    
      
      
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:400,700|Source+Code+Pro">
      <style>
        body, input {
          font-family: 'Roboto', Helvetica, Arial, sans-serif;
        }
        pre, code {
          font-family: 'Source Code Pro', 'Courier New', 'Courier', monospace;
        }
      </style>
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script src="../../assets/javascripts/modernizr-4ab42b99fd.js"></script>
    
  </head>
  
  
  
  <body class="palette-primary-deep-purple palette-accent-deep-purple">
    
      
      
    
    <div class="backdrop">
      <div class="backdrop-paper"></div>
    </div>
    <input class="toggle" type="checkbox" id="toggle-drawer">
    <input class="toggle" type="checkbox" id="toggle-search">
    <label class="toggle-button overlay" for="toggle-drawer"></label>
    <header class="header">
      <nav aria-label="Header">
  <div class="bar default">
    <div class="button button-menu" role="button" aria-label="Menu">
      <label class="toggle-button icon icon-menu" for="toggle-drawer">
        <span></span>
      </label>
    </div>
    <div class="stretch">
      <div class="title">
        
          <span class="path">
            
              
                Docker <i class="icon icon-link"></i>
              
            
          </span>
        
        How to run your build locally in Docker
      </div>
    </div>
    
    
    <div class="button button-search" role="button" aria-label="Search">
      <label class="toggle-button icon icon-search" title="Search" for="toggle-search"></label>
    </div>
  </div>
  <div class="bar search">
    <div class="button button-close" role="button" aria-label="Close">
      <label class="toggle-button icon icon-back" for="toggle-search"></label>
    </div>
    <div class="stretch">
      <div class="field">
        <input class="query" type="text" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck>
      </div>
    </div>
    <div class="button button-reset" role="button" aria-label="Search">
      <button class="toggle-button icon icon-close" id="reset-search"></button>
    </div>
  </div>
</nav>
    </header>
    <main class="main">
      
      <div class="drawer">
        <nav aria-label="Navigation">
  
  <a href="https://github.com/bitrise-io/devcenter" class="project">
    <div class="banner">
      
        <div class="logo">
          <img src="../../img/logo.svg">
        </div>
      
      <div class="name">
        <strong>
          Bitrise DevCenter
          <span class="version">
            
          </span>
        </strong>
        
          <br>
          bitrise-io/devcenter
        
      </div>
    </div>
  </a>
  <div class="scrollable">
    <div class="wrapper">
      
        <ul class="repo">
          <li class="repo-download">
            
            <a href="https://github.com/bitrise-io/devcenter/archive/master.zip" target="_blank" title="Download" data-action="download">
              <i class="icon icon-download"></i> Download
            </a>
          </li>
          <li class="repo-stars">
            <a href="https://github.com/bitrise-io/devcenter/stargazers" target="_blank" title="Stargazers" data-action="star">
              <i class="icon icon-star"></i> Stars
              <span class="count">&ndash;</span>
            </a>
          </li>
        </ul>
        <hr>
      
      <div class="toc">
        <ul>
          
            
  <li>
    <a class="" title="Bitrise DevCenter - What is Bitrise?" href="../..">
      Bitrise DevCenter - What is Bitrise?
    </a>
    
  </li>

          
            
  <li>
    <span class="section">Getting Started</span>
    <ul>
      
        
  <li>
    <a class="" title="Builds & Workflows" href="../../getting-started/builds-and-workflows/">
      Builds & Workflows
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Code Security" href="../../getting-started/code-security/">
      Code Security
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Create your first App on Bitrise.io" href="../../getting-started/create-your-first-app-on-bitrise/">
      Create your first App on Bitrise.io
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Add your first Step to your Workflow" href="../../getting-started/add-your-first-step-to-your-workflow/">
      Add your first Step to your Workflow
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Manage your Bitrise workflow" href="../../getting-started/manage-your-bitrise-workflow/">
      Manage your Bitrise workflow
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Infrastructure</span>
    <ul>
      
        
  <li>
    <a class="" title="Available Stacks" href="../../infrastructure/available-stacks/">
      Available Stacks
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Virtual Machines" href="../../infrastructure/virtual-machines/">
      Virtual Machines
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Signing up</span>
    <ul>
      
        
  <li>
    <a class="" title="Signing up with GitHub" href="../../signing-up/signing-up-with-github/">
      Signing up with GitHub
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Signing up with Bitbucket" href="../../signing-up/signing-up-with-bitbucket/">
      Signing up with Bitbucket
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Signing up with email" href="../../signing-up/signing-up-with-email/">
      Signing up with email
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Trial after signing up" href="../../signing-up/trial-after-signing-up/">
      Trial after signing up
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Adding a new app</span>
    <ul>
      
        
  <li>
    <a class="" title="Adding a new app" href="../../adding-a-new-app/">
      Adding a new app
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Connecting a repository" href="../../adding-a-new-app/connecting-a-repository/">
      Connecting a repository
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Setting up SSH keys" href="../../adding-a-new-app/setting-up-ssh-keys/">
      Setting up SSH keys
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Setting up configuration" href="../../adding-a-new-app/setting-up-configuration/">
      Setting up configuration
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Tutorials</span>
    <ul>
      
        
  <li>
    <a class="" title="Community Created Tutorials" href="../../tutorials/community-created/">
      Community Created Tutorials
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Create signed APK on bitrise.io" href="../../tutorials/create-signed-apk-on-bitrise/">
      Create signed APK on bitrise.io
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="HipChat message with build status and details" href="../../tutorials/hipchat-message/">
      HipChat message with build status and details
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Download or replace project resources" href="../../tutorials/download-or-replace-project-resources/">
      Download or replace project resources
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Efficient Continuous Integration and Deployment Workflow for iOS development" href="../../tutorials/efficient-continuous-integration-and-deployment-workflow-for-ios/">
      Efficient Continuous Integration and Deployment Workflow for iOS development
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Configure and connect to your VPN" href="../../tutorials/vpn-configuration/">
      Configure and connect to your VPN
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Team management</span>
    <ul>
      
        
  <li>
    <a class="" title="Adding a new team member" href="../../team-management/">
      Adding a new team member
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Changing the owner of an app" href="../../team-management/changing-the-owner-of-an-app/">
      Changing the owner of an app
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Webhooks</span>
    <ul>
      
        
  <li>
    <a class="" title="Adding webhooks" href="../../webhooks/">
      Adding webhooks
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Adding a GitHub webhook" href="../../webhooks/adding-a-github-webhook/">
      Adding a GitHub webhook
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Adding a Bitbucket webhook" href="../../webhooks/adding-a-bitbucket-webhook/">
      Adding a Bitbucket webhook
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Control what to build when, with the Trigger Map" href="../../webhooks/trigger-map/">
      Control what to build when, with the Trigger Map
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Caching</span>
    <ul>
      
        
  <li>
    <a class="" title="About caching" href="../../caching/about-caching/">
      About caching
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Caching Cocoapods" href="../../caching/caching-cocoapods/">
      Caching Cocoapods
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Caching Gradle" href="../../caching/caching-gradle/">
      Caching Gradle
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Caching Maven" href="../../caching/caching-maven/">
      Caching Maven
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Caching Ruby GEMs" href="../../caching/caching-ruby-gems/">
      Caching Ruby GEMs
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">iOS</span>
    <ul>
      
        
  <li>
    <a class="" title="Code Signing" href="../../ios/code-signing/">
      Code Signing
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Uploading certificates" href="../../ios/uploading-certificates/">
      Uploading certificates
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="How to export Certificates and Provisioning Profiles" href="../../ios/export-certificate-and-provisioning-profile/">
      How to export Certificates and Provisioning Profiles
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Resigning an IPA" href="../../ios/resigning-an-ipa/">
      Resigning an IPA
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Frequent iOS issues" href="../../ios/frequent-ios-issues/">
      Frequent iOS issues
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="List of known Xcode issues" href="../../ios/known-xcode-issues/">
      List of known Xcode issues
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Android</span>
    <ul>
      
        
  <li>
    <a class="" title="Frequent Android issues" href="../../android/frequent-android-issues/">
      Frequent Android issues
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Docker</span>
    <ul>
      
        
  <li>
    <a class="current" title="How to run your build locally in Docker" href="./">
      How to run your build locally in Docker
    </a>
    
      
      
        <ul>
          
            <li class="anchor">
              <a title="TL;DR;" href="#tldr">
                TL;DR;
              </a>
            </li>
          
            <li class="anchor">
              <a title="Getting started" href="#getting-started">
                Getting started
              </a>
            </li>
          
            <li class="anchor">
              <a title="Run your builds" href="#run-your-builds">
                Run your builds
              </a>
            </li>
          
        </ul>
      
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Tips & Tricks</span>
    <ul>
      
        
  <li>
    <a class="" title="Skip a Build (skip ci)" href="../../tips-and-tricks/skip-a-build/">
      Skip a Build (skip ci)
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Attach any file as an Artifact to the Build" href="../../tips-and-tricks/attach-any-file-to-build/">
      Attach any file as an Artifact to the Build
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Expose an Environment Variable and use it in another Step" href="../../tips-and-tricks/expose-environment-variable/">
      Expose an Environment Variable and use it in another Step
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Don't mark the Build as failed if a given step would fail (ignore the error of the Step)" href="../../tips-and-tricks/dont-mark-build-failed-if-step-fails/">
      Don't mark the Build as failed if a given step would fail (ignore the error of the Step)
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Enable/Disable a step (optionally, based on a condition)" href="../../tips-and-tricks/disable-a-step-by-condition/">
      Enable/Disable a step (optionally, based on a condition)
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Xcode Archive: export options" href="../../tips-and-tricks/xcodebuild-export-options/">
      Xcode Archive: export options
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Install Any Additional Tool" href="../../tips-and-tricks/install-additional-tools/">
      Install Any Additional Tool
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="How to configure fastlane match for Bitrise" href="../../tips-and-tricks/how-to-configure-fastlane-match-for-bitrise/">
      How to configure fastlane match for Bitrise
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Frequently Asked Questions (FAQ)</span>
    <ul>
      
        
  <li>
    <a class="" title="Available Environment Variables" href="../../faq/available-environment-variables/">
      Available Environment Variables
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="How to change the owner of an app" href="../../faq/how-to-change-the-owner-of-an-app/">
      How to change the owner of an app
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Organization FAQ" href="../../faq/organization-faq/">
      Organization FAQ
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Adding projects with submodules or with private CocoaPods repos" href="../../faq/adding-projects-with-submodules/">
      Adding projects with submodules or with private CocoaPods repos
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="Android x86 Emulator" href="../../faq/android-x86-emulator/">
      Android x86 Emulator
    </a>
    
  </li>

      
        
  <li>
    <a class="" title="How to generate an SSH key pair" href="../../faq/how-to-generate-ssh-keypair/">
      How to generate an SSH key pair
    </a>
    
  </li>

      
    </ul>
  </li>

          
            
  <li>
    <span class="section">Tools</span>
    <ul>
      
        
  <li>
    <a class="" title="Bitrise Tools" href="../../tools/bitrise-tools/">
      Bitrise Tools
    </a>
    
  </li>

      
    </ul>
  </li>

          
        </ul>
        
      </div>
    </div>
  </div>
</nav>
      </div>
      <article class="article">
        <div class="wrapper">
          
            <h1>How to run your build locally in Docker</h1>
          
          <p>To be able to run your Linux stack builds locally you'll need <a href="https://www.docker.com/">docker</a>.</p>
<p>For Linux just follow the <a href="https://docs.docker.com/engine/installation/linux/">official install instructions</a>.</p>
<p>For Mac you can use <a href="https://www.docker.com/products/docker#/mac">Docker for Mac</a>,
which is probably the easiest way to get started.</p>
<p>For this example we'll use <a href="https://github.com/bitrise-samples/sample-apps-android-sdk22">this Bitrise Android sample project</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Large images ahead</p>
<p>The official Bitrise Docker images are quite large, due to the fact that it includes
a wide variety of preinstalled tools. You'll need at <strong>least</strong> 20-25 GB free disk space!</p>
</div>
<p>If you're not familiar with the <a href="https://www.bitrise.io/cli">Bitrise CLI</a>
you should try that first. You don't have to master the CLI,
if you know what <code>bitrise run WORKFLOW</code> does, that should be enough for this tutorial.</p>
<h2 id="tldr">TL;DR;<a class="headerlink" href="#tldr" title="Permanent link">⚓</a></h2>
<p>If you're familiar with <code>docker</code> and the <code>bitrise</code> CLI:</p>
<ol>
<li>Install <a href="https://www.docker.com/">docker</a></li>
<li>Make sure you have your <code>bitrise.yml</code> in your repository (you don't have to commit it, but the file have to exist in your repository's root directory)</li>
<li><code>cd</code> into your repository's directory on your Mac/Linux</li>
<li><code>docker pull bitriseio/docker-android:latest</code></li>
<li><code>docker run --privileged --env CI=false --volume "$(pwd):/bitrise/src" --volume "/var/run/docker.sock:/var/run/docker.sock" --rm bitriseio/docker-android:latest bitrise run WORKFLOW</code></li>
</ol>
<p><em>Keep reading if you want to read more details and notes about the process and commands!</em></p>
<h2 id="getting-started">Getting started<a class="headerlink" href="#getting-started" title="Permanent link">⚓</a></h2>
<p>Open your Terminal / Command Line, and download the docker image you want to use.
In general, if your project is an Android project but you don't use the Android NDK,
to preserve precious disk space you should use the
<a href="https://hub.docker.com/r/bitriseio/docker-android/">bitriseio/docker-android</a> docker image.
You can find other official Bitrise docker images <a href="https://hub.docker.com/u/bitriseio/">on our Docker Hub page</a>.
For this example we'll use the <code>bitriseio/docker-android</code> one.</p>
<p>Downloading docker images from the <a href="https://hub.docker.com">Docker Hub</a> is quite easy:</p>
<pre class="code"><code>docker pull bitriseio/docker-android:latest</code></pre>


<p>Be prepared, this can take quite a bit of time, as this image is over 10 GB.
<em>If the download would fail or hang, you can restart it any time by running
the same command again.</em></p>
<p>Once the download succeeds you have everything prepared to run your build
in Docker! The last thing you have to do is to download your Bitrise build
configuration (<code>bitrise.yml</code>).</p>
<div class="admonition note">
<p class="admonition-title"><code>bitrise.yml</code></p>
<p>You can download your project's <code>bitrise.yml</code> from the <strong>Workflow Editor</strong>
on <a href="https://www.bitrise.io">bitrise.io</a>, under the <code>bitrise.yml</code> section.</p>
</div>
<p>In your Terminal / Command Line go to (<code>cd</code>) the root directory
of <em>your repository</em>, and make sure your <code>bitrise.yml</code> is at this location.</p>
<h2 id="run-your-builds">Run your builds<a class="headerlink" href="#run-your-builds" title="Permanent link">⚓</a></h2>
<p>The only thing left to do is to actually run a build:</p>
<pre class="code"><code>docker run --privileged --env CI=false --volume &quot;$(pwd):/bitrise/src&quot; --volume &quot;/var/run/docker.sock:/var/run/docker.sock&quot; --rm bitriseio/docker-android:latest bitrise run WORKFLOW</code></pre>


<p><em>Don't forget to replace <code>WORKFLOW</code> with the actual ID of your workflow in your <code>bitrise.yml</code>,
with something like <code>primary</code>!</em></p>
<p>This command will share the current directory (the directory of your repository)
as a shared volume with the docker container, and will make it available <strong>inside</strong> the
container at the path <code>/bitrise/src</code>.</p>
<p>The <code>--env CI=false</code> flag sets the environment variable <code>CI</code> to <code>false</code> - this will
make Bitrise CLI to skip certain steps which only make sense to run in a Continuous Integration
environment. An example is the <code>Git Clone</code> step - you already have your code, so there's
no need to git clone it again inside the docker container (that's why we
shared the code directory as a <code>--volume</code>).</p>
<p>The <code>--rm</code> flag tells docker to discard the container after the <code>docker run</code>
command finishes. This means that if you run the command again, the only thing which will
persist between the <code>docker run ..</code> commands are the files stored at the shared <code>--volume</code>
(in your repository's directory). Every other file which is generated into a temp
or any other location will be discarded / won't be kept. If you want to
debug the container after a failed build feel free to remove the <code>--rm</code> flag,
and check out a Docker tutorial about how you can connect to an existing
docker container - <em>Note: simply running the command again <strong>will not</strong> use the same container,
but <strong>will create a new one</strong></em>!</p>
<p>The <code>--privileged</code> flag allows access control of the host (!) from the docker container,
so you should never use this flag unless you trust the docker image you will use!
This flag is required for allowing VPNs to work (to change network configs
of the host) for example.</p>
<p>The <code>--volume "/var/run/docker.sock:/var/run/docker.sock"</code> flag exposes the
docker socket from the host for the container - this is required
if you want to run other docker containers from whithin the container,
or if you want to run any <code>docker</code> command during your build / inside the container.</p>
          <aside class="copyright" role="note">
            
            Documentation built with
            <a href="http://www.mkdocs.org" target="_blank">MkDocs</a>
            using the
            <a href="http://squidfunk.github.io/mkdocs-material/" target="_blank">
              Material
            </a>
            theme.
          </aside>
          
            <footer class="footer">
              
  <nav class="pagination" aria-label="Footer">
    <div class="previous">
      
        <a href="../../android/frequent-android-issues/" title="Frequent Android issues">
          <span class="direction">
            Previous
          </span>
          <div class="page">
            <div class="button button-previous" role="button" aria-label="Previous">
              <i class="icon icon-back"></i>
            </div>
            <div class="stretch">
              <div class="title">
                Frequent Android issues
              </div>
            </div>
          </div>
        </a>
      
    </div>
    <div class="next">
      
        <a href="../../tips-and-tricks/skip-a-build/" title="Skip a Build (skip ci)">
          <span class="direction">
            Next
          </span>
          <div class="page">
            <div class="stretch">
              <div class="title">
                Skip a Build (skip ci)
              </div>
            </div>
            <div class="button button-next" role="button" aria-label="Next">
              <i class="icon icon-forward"></i>
            </div>
          </div>
        </a>
      
    </div>
  </nav>

            </footer>
          
        </div>
      </article>
      <div class="results" role="status" aria-live="polite">
        <div class="scrollable">
          <div class="wrapper">
            <div class="meta"></div>
            <div class="list"></div>
          </div>
        </div>
      </div>
    </main>
    <script>
      var base_url = '../..';
      var repo_id  = 'bitrise-io/devcenter';
    </script>
    <script src="../../assets/javascripts/application-997097ee0c.js"></script>
    
    
  </body>
</html>